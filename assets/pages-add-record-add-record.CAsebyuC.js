import{l as e,r as a,m as l,p as s,D as t,E as c,c as u,w as o,B as n,h as d,i,o as r,b as v,e as f,f as m,z as _,F as p,A as y,y as g,I as k,x,g as Y,s as h}from"./index-BrtSbkGa.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=C({__name:"add-record",setup(C,{expose:b}){const D=e(),M=a(!1),V=a("expense"),w=a(""),F=a(""),U=a(""),j=a(l().format("YYYY-MM-DD")),I=s(()=>D.categories[V.value]),T=s(()=>w.value&&F.value&&parseFloat(F.value)>0),z=e=>{V.value=e,w.value=""},A=e=>{j.value=e.detail.value},B=async()=>{if(!T.value)return void h({title:"请填写完整信息",icon:"none"});const e={type:V.value,category:w.value,amount:parseFloat(F.value),remark:U.value,date:j.value};try{const a=await D.addRecord(e);a.success?(h({title:"记录成功",icon:"success"}),E(),R()):h({title:a.message||"保存失败",icon:"none"})}catch(a){h({title:"网络错误，请重试",icon:"none"})}},E=()=>{V.value="expense",w.value="",F.value="",U.value="",j.value=l().format("YYYY-MM-DD")},R=()=>{M.value=!1,setTimeout(()=>{E(),d({url:"/pages/detail/detail"})},300)},q=()=>{M.value=!0};return b({openModal:q}),t(()=>{setTimeout(()=>{q()},100)}),c(()=>{console.log("出去"),R()}),(e,a)=>{const s=i,t=f,c=k,d=x,h=Y;return r(),u(s,{class:n(["add-record-container",{show:M.value}])},{default:o(()=>[v(s,{class:"mask",onClick:R}),v(s,{class:n(["modal-content",{slideUp:M.value}])},{default:o(()=>[v(s,{class:"modal-header"},{default:o(()=>[v(t,{class:"header-title"},{default:o(()=>[m("记一笔")]),_:1}),v(t,{class:"close-btn",onClick:R},{default:o(()=>[m("×")]),_:1})]),_:1}),v(s,{class:"type-selector"},{default:o(()=>[v(s,{class:n(["type-item",{active:"expense"===V.value}]),onClick:a[0]||(a[0]=e=>z("expense"))},{default:o(()=>[v(t,{class:"type-text"},{default:o(()=>[m("支出")]),_:1})]),_:1},8,["class"]),v(s,{class:n(["type-item",{active:"income"===V.value}]),onClick:a[1]||(a[1]=e=>z("income"))},{default:o(()=>[v(t,{class:"type-text"},{default:o(()=>[m("收入")]),_:1})]),_:1},8,["class"])]),_:1}),v(s,{class:"category-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[m("选择类别")]),_:1}),v(s,{class:"category-grid"},{default:o(()=>[(r(!0),_(p,null,y(I.value,e=>(r(),u(s,{key:e.id,class:n(["category-item",{active:w.value===e.name}]),onClick:a=>{return l=e.name,void(w.value=l);var l}},{default:o(()=>[v(t,{class:"category-icon"},{default:o(()=>[m(g(e.icon),1)]),_:2},1024),v(t,{class:"category-name"},{default:o(()=>[m(g(e.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),v(s,{class:"amount-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[m("金额")]),_:1}),v(s,{class:"amount-input-container"},{default:o(()=>[v(t,{class:"currency-symbol"},{default:o(()=>[m("¥")]),_:1}),v(c,{class:"amount-input",modelValue:F.value,"onUpdate:modelValue":a[2]||(a[2]=e=>F.value=e),type:"digit",placeholder:"0.00",focus:""},null,8,["modelValue"])]),_:1})]),_:1}),v(s,{class:"remark-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[m("备注")]),_:1}),v(c,{class:"remark-input",modelValue:U.value,"onUpdate:modelValue":a[3]||(a[3]=e=>U.value=e),placeholder:"添加备注（可选）",maxlength:"50"},null,8,["modelValue"])]),_:1}),v(s,{class:"date-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[m("日期")]),_:1}),v(d,{mode:"date",value:j.value,onChange:A},{default:o(()=>[v(s,{class:"date-display"},{default:o(()=>[v(t,{class:"date-text"},{default:o(()=>{return[m(g((e=j.value,l(e).format("YYYY年MM月DD日"))),1)];var e}),_:1}),v(t,{class:"date-icon"},{default:o(()=>[m("▼")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),v(s,{class:"action-buttons"},{default:o(()=>[v(h,{class:"cancel-btn",onClick:R},{default:o(()=>[m("取消")]),_:1}),v(h,{class:"confirm-btn",onClick:B,disabled:!T.value},{default:o(()=>[m("完成")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"])]),_:1},8,["class"])}}},[["__scopeId","data-v-23905361"]]);export{b as default};
