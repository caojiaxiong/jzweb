import{u as e,r as a,d as l,c as s,q as t,v as c,a as u,w as o,p as n,x as d,i,b as r,e as v,j as m,k as f,l as _,F as p,m as y,t as g,I as k,h as x,y as Y,z as h}from"./index-COzZxKlP.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const b=C({__name:"add-record",setup(C,{expose:b}){const M=e(),D=a(!1),V=a("expense"),j=a(""),w=a(""),F=a(""),U=a(l().format("YYYY-MM-DD")),I=s(()=>M.categories[V.value]),T=s(()=>j.value&&w.value&&parseFloat(w.value)>0),q=e=>{V.value=e,j.value=""},z=e=>{U.value=e.detail.value},R=async()=>{if(!T.value)return void h({title:"请填写完整信息",icon:"none"});const e={type:V.value,category:j.value,amount:parseFloat(w.value),remark:F.value,date:U.value};try{const a=await M.addRecord(e);a.success?(h({title:"记录成功",icon:"success"}),A(),B()):h({title:a.message||"保存失败",icon:"none"})}catch(a){h({title:"网络错误，请重试",icon:"none"})}},A=()=>{V.value="expense",j.value="",w.value="",F.value="",U.value=l().format("YYYY-MM-DD")},B=()=>{D.value=!1,setTimeout(()=>{A(),d({url:"/pages/detail/detail"})},300)},E=()=>{D.value=!0};return b({openModal:E}),t(()=>{setTimeout(()=>{E()},100)}),c(()=>{console.log("出去"),B()}),(e,a)=>{const s=i,t=m,c=k,d=x,h=Y;return r(),u(s,{class:n(["add-record-container",{show:D.value}])},{default:o(()=>[v(s,{class:"mask",onClick:B}),v(s,{class:n(["modal-content",{slideUp:D.value}])},{default:o(()=>[v(s,{class:"modal-header"},{default:o(()=>[v(t,{class:"header-title"},{default:o(()=>[f("记一笔")]),_:1}),v(t,{class:"close-btn",onClick:B},{default:o(()=>[f("×")]),_:1})]),_:1}),v(s,{class:"type-selector"},{default:o(()=>[v(s,{class:n(["type-item",{active:"expense"===V.value}]),onClick:a[0]||(a[0]=e=>q("expense"))},{default:o(()=>[v(t,{class:"type-text"},{default:o(()=>[f("支出")]),_:1})]),_:1},8,["class"]),v(s,{class:n(["type-item",{active:"income"===V.value}]),onClick:a[1]||(a[1]=e=>q("income"))},{default:o(()=>[v(t,{class:"type-text"},{default:o(()=>[f("收入")]),_:1})]),_:1},8,["class"])]),_:1}),v(s,{class:"category-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[f("选择类别")]),_:1}),v(s,{class:"category-grid"},{default:o(()=>[(r(!0),_(p,null,y(I.value,e=>(r(),u(s,{key:e.id,class:n(["category-item",{active:j.value===e.name}]),onClick:a=>{return l=e.name,void(j.value=l);var l}},{default:o(()=>[v(t,{class:"category-icon"},{default:o(()=>[f(g(e.icon),1)]),_:2},1024),v(t,{class:"category-name"},{default:o(()=>[f(g(e.name),1)]),_:2},1024)]),_:2},1032,["class","onClick"]))),128))]),_:1})]),_:1}),v(s,{class:"amount-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[f("金额")]),_:1}),v(s,{class:"amount-input-container"},{default:o(()=>[v(t,{class:"currency-symbol"},{default:o(()=>[f("¥")]),_:1}),v(c,{class:"amount-input",modelValue:w.value,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value=e),type:"digit",placeholder:"0.00",focus:""},null,8,["modelValue"])]),_:1})]),_:1}),v(s,{class:"remark-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[f("备注")]),_:1}),v(c,{class:"remark-input",modelValue:F.value,"onUpdate:modelValue":a[3]||(a[3]=e=>F.value=e),placeholder:"添加备注（可选）",maxlength:"50"},null,8,["modelValue"])]),_:1}),v(s,{class:"date-section"},{default:o(()=>[v(t,{class:"section-title"},{default:o(()=>[f("日期")]),_:1}),v(d,{mode:"date",value:U.value,onChange:z},{default:o(()=>[v(s,{class:"date-display"},{default:o(()=>[v(t,{class:"date-text"},{default:o(()=>{return[f(g((e=U.value,l(e).format("YYYY年MM月DD日"))),1)];var e}),_:1}),v(t,{class:"date-icon"},{default:o(()=>[f("▼")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),v(s,{class:"action-buttons"},{default:o(()=>[v(h,{class:"cancel-btn",onClick:B},{default:o(()=>[f("取消")]),_:1}),v(h,{class:"confirm-btn",onClick:R,disabled:!T.value},{default:o(()=>[f("完成")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["class"])]),_:1},8,["class"])}}},[["__scopeId","data-v-23905361"]]);export{b as default};
