import{l as e,r as a,m as t,p as s,q as l,c as n,w as c,i as u,o,b as d,x as r,e as f,f as i,y as m,z as _,F as p,A as h,B as v,h as x,$ as y}from"./index-Cxq9ffu1.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=b({__name:"bill",setup(b){const g=e(),F=a(t().format("YYYY")),$=s(()=>{const e=parseInt(F.value),a=t(`${e}-01-01`),s=t(`${e}-12-31`);return g.getRecordsByDateRange(a,s)}),k=s(()=>$.value.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0)),R=s(()=>$.value.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0)),Y=s(()=>k.value-R.value),w=s(()=>{const e=parseInt(F.value),a=[];for(let t=1;t<=12;t++){const s=g.getRecordsByMonth(e,t),l=s.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),n=s.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0),c=l-n;a.push({month:`${e}-${t.toString().padStart(2,"0")}`,income:l,expense:n,balance:c})}return a.filter(e=>e.income>0||e.expense>0)}),B=e=>{F.value=e.detail.value},C=e=>{const[a,t]=e.split("-");return`${t}月`};return l(async()=>{await g.fetchRecords()}),(e,a)=>{const t=f,s=u,l=r;return o(),n(s,{class:"bill-container"},{default:c(()=>[d(s,{class:"custom-navbar"},{default:c(()=>[d(s,{class:"navbar-left"},{default:c(()=>[d(l,{mode:"date",fields:"year",value:F.value,onChange:B},{default:c(()=>[d(s,{class:"year-selector"},{default:c(()=>[d(t,{class:"year-text"},{default:c(()=>[i(m(F.value)+"年",1)]),_:1}),d(t,{class:"year-icon"},{default:c(()=>[i("▼")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),d(s,{class:"navbar-center"},{default:c(()=>[d(t,{class:"app-title"},{default:c(()=>[i("个人记账")]),_:1})]),_:1}),d(s,{class:"navbar-right"},{default:c(()=>[d(t,{class:"placeholder"})]),_:1})]),_:1}),d(s,{class:"yearly-stats"},{default:c(()=>[d(s,{class:"stat-item"},{default:c(()=>[d(t,{class:"stat-label"},{default:c(()=>[i("结余")]),_:1}),d(t,{class:"stat-amount balance"},{default:c(()=>[i("¥"+m(Y.value.toFixed(2)),1)]),_:1})]),_:1}),d(s,{class:"stat-item"},{default:c(()=>[d(t,{class:"stat-label"},{default:c(()=>[i("收入")]),_:1}),d(t,{class:"stat-amount income"},{default:c(()=>[i("¥"+m(k.value.toFixed(2)),1)]),_:1})]),_:1}),d(s,{class:"stat-item"},{default:c(()=>[d(t,{class:"stat-label"},{default:c(()=>[i("支出")]),_:1}),d(t,{class:"stat-amount expense"},{default:c(()=>[i("¥"+m(R.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1}),d(s,{class:"monthly-list"},{default:c(()=>[d(s,{class:"list-header"},{default:c(()=>[d(t,{class:"header-title"},{default:c(()=>[i("月度账单")]),_:1})]),_:1}),0===w.value.length?(o(),n(s,{key:0,class:"empty-state"},{default:c(()=>[d(t,{class:"empty-text"},{default:c(()=>[i("暂无账单数据")]),_:1})]),_:1})):(o(),n(s,{key:1,class:"list-container"},{default:c(()=>[(o(!0),_(p,null,h(w.value,e=>(o(),n(s,{key:e.month,class:"month-item",onClick:a=>(e=>{x({url:"/pages/detail/detail"}),setTimeout(()=>{y("setSelectedDate",e.month)},100)})(e)},{default:c(()=>[d(s,{class:"month-left"},{default:c(()=>[d(t,{class:"month-text"},{default:c(()=>[i(m(C(e.month)),1)]),_:2},1024)]),_:2},1024),d(s,{class:"month-center"},{default:c(()=>[d(s,{class:"month-stats"},{default:c(()=>[d(t,{class:"month-income"},{default:c(()=>[i("收入: ¥"+m(e.income.toFixed(2)),1)]),_:2},1024),d(t,{class:"month-expense"},{default:c(()=>[i("支出: ¥"+m(e.expense.toFixed(2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),d(s,{class:"month-right"},{default:c(()=>{return[d(t,{class:v(["month-balance",(a=e.balance,a>=0?"positive":"negative")])},{default:c(()=>[i(m(e.balance>=0?"+":"")+"¥"+m(e.balance.toFixed(2)),1)]),_:2},1032,["class"]),d(t,{class:"month-arrow"},{default:c(()=>[i(">")]),_:1})];var a}),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-a8f46e6d"]]);export{g as default};
