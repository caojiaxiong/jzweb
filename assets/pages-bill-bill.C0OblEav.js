import{u as e,r as a,d as t,c as s,o as l,a as n,w as u,i as c,b as o,e as d,h as r,j as i,k as f,t as m,l as _,F as p,m as h,p as v,x,$ as y}from"./index-COzZxKlP.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const g=b({__name:"bill",setup(b){const g=e(),F=a(t().format("YYYY")),k=s(()=>{const e=parseInt(F.value),a=t(`${e}-01-01`),s=t(`${e}-12-31`);return g.getRecordsByDateRange(a,s)}),$=s(()=>k.value.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0)),R=s(()=>k.value.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0)),Y=s(()=>$.value-R.value),j=s(()=>{const e=parseInt(F.value),a=[];for(let t=1;t<=12;t++){const s=g.getRecordsByMonth(e,t),l=s.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0),n=s.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0),u=l-n;a.push({month:`${e}-${t.toString().padStart(2,"0")}`,income:l,expense:n,balance:u})}return a.filter(e=>e.income>0||e.expense>0)}),w=e=>{F.value=e.detail.value},C=e=>{const[a,t]=e.split("-");return`${t}月`};return l(async()=>{await g.fetchRecords()}),(e,a)=>{const t=i,s=c,l=r;return o(),n(s,{class:"bill-container"},{default:u(()=>[d(s,{class:"custom-navbar"},{default:u(()=>[d(s,{class:"navbar-left"},{default:u(()=>[d(l,{mode:"date",fields:"year",value:F.value,onChange:w},{default:u(()=>[d(s,{class:"year-selector"},{default:u(()=>[d(t,{class:"year-text"},{default:u(()=>[f(m(F.value)+"年",1)]),_:1}),d(t,{class:"year-icon"},{default:u(()=>[f("▼")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),d(s,{class:"navbar-center"},{default:u(()=>[d(t,{class:"app-title"},{default:u(()=>[f("个人记账")]),_:1})]),_:1}),d(s,{class:"navbar-right"},{default:u(()=>[d(t,{class:"placeholder"})]),_:1})]),_:1}),d(s,{class:"yearly-stats"},{default:u(()=>[d(s,{class:"stat-item"},{default:u(()=>[d(t,{class:"stat-label"},{default:u(()=>[f("结余")]),_:1}),d(t,{class:"stat-amount balance"},{default:u(()=>[f("¥"+m(Y.value.toFixed(2)),1)]),_:1})]),_:1}),d(s,{class:"stat-item"},{default:u(()=>[d(t,{class:"stat-label"},{default:u(()=>[f("收入")]),_:1}),d(t,{class:"stat-amount income"},{default:u(()=>[f("¥"+m($.value.toFixed(2)),1)]),_:1})]),_:1}),d(s,{class:"stat-item"},{default:u(()=>[d(t,{class:"stat-label"},{default:u(()=>[f("支出")]),_:1}),d(t,{class:"stat-amount expense"},{default:u(()=>[f("¥"+m(R.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1}),d(s,{class:"monthly-list"},{default:u(()=>[d(s,{class:"list-header"},{default:u(()=>[d(t,{class:"header-title"},{default:u(()=>[f("月度账单")]),_:1})]),_:1}),0===j.value.length?(o(),n(s,{key:0,class:"empty-state"},{default:u(()=>[d(t,{class:"empty-text"},{default:u(()=>[f("暂无账单数据")]),_:1})]),_:1})):(o(),n(s,{key:1,class:"list-container"},{default:u(()=>[(o(!0),_(p,null,h(j.value,e=>(o(),n(s,{key:e.month,class:"month-item",onClick:a=>(e=>{x({url:"/pages/detail/detail"}),setTimeout(()=>{y("setSelectedDate",e.month)},100)})(e)},{default:u(()=>[d(s,{class:"month-left"},{default:u(()=>[d(t,{class:"month-text"},{default:u(()=>[f(m(C(e.month)),1)]),_:2},1024)]),_:2},1024),d(s,{class:"month-center"},{default:u(()=>[d(s,{class:"month-stats"},{default:u(()=>[d(t,{class:"month-income"},{default:u(()=>[f("收入: ¥"+m(e.income.toFixed(2)),1)]),_:2},1024),d(t,{class:"month-expense"},{default:u(()=>[f("支出: ¥"+m(e.expense.toFixed(2)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),d(s,{class:"month-right"},{default:u(()=>{return[d(t,{class:v(["month-balance",(a=e.balance,a>=0?"positive":"negative")])},{default:u(()=>[f(m(e.balance>=0?"+":"")+"¥"+m(e.balance.toFixed(2)),1)]),_:2},1032,["class"]),d(t,{class:"month-arrow"},{default:u(()=>[f(">")]),_:1})];var a}),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-a8f46e6d"]]);export{g as default};
