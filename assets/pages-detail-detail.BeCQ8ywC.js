import{k as e,l as a,r as t,m as s,p as l,q as c,c as o,w as d,i as u,o as r,b as n,t as i,v as f,x as _,e as m,f as p,y as v,z as y,F as g,A as x,B as h,C as k,D as Y,h as M,s as C}from"./index-rr4Jtksk.js";import{_ as b}from"./_plugin-vue_export-helper.BCo6x5W8.js";const F=b({__name:"detail",setup(b){const{safeAreaInsets:F}=e(),I=a(),w=t(s().format("YYYY-MM")),D=t("expense"),R=l(()=>s(w.value).format("YYYYå¹´MMæœˆ")),j=l(()=>{const[e,a]=w.value.split("-");return console.log(e,"year"),console.log(a,"month"),I.getRecordsByMonth(parseInt(e),parseInt(a))}),A=l(()=>j.value),B=l(()=>j.value.filter(e=>"income"===e.type).reduce((e,a)=>e+a.amount,0)),q=l(()=>j.value.filter(e=>"expense"===e.type).reduce((e,a)=>e+a.amount,0)),z=l(()=>B.value-q.value),E=e=>{w.value=e.detail.value},G=e=>{console.log(e);const a=I.categories[D.value].find(a=>a.name===e);return a?a.icon:"ðŸ“"};return c(async()=>{await I.fetchRecords()}),(e,a)=>{const t=u,l=m,c=_;return r(),o(t,{class:"detail-container"},{default:d(()=>[n(t,{style:i({height:f(F).top+10+"px"})},null,8,["style"]),n(t,{class:"top"},{default:d(()=>[n(t,{class:"date-selector"},{default:d(()=>[n(t,{class:"time"},{default:d(()=>[n(c,{mode:"date",fields:"month",value:w.value,onChange:E},{default:d(()=>[n(t,{class:"date-display"},{default:d(()=>[n(l,{class:"date-text"},{default:d(()=>[p(v(R.value),1)]),_:1}),n(l,{class:"date-icon"},{default:d(()=>[p("â–¼")]),_:1})]),_:1})]),_:1},8,["value"])]),_:1}),n(t,{class:"title"},{default:d(()=>[p("æ›¹ç­±å›è®°è´¦")]),_:1})]),_:1}),n(t,{class:"stats-cards"},{default:d(()=>[n(t,{class:"stat-card income"},{default:d(()=>[n(l,{class:"stat-label"},{default:d(()=>[p("æ”¶å…¥")]),_:1}),n(l,{class:"stat-amount"},{default:d(()=>[p("Â¥"+v(B.value.toFixed(2)),1)]),_:1})]),_:1}),n(t,{class:"stat-card expense"},{default:d(()=>[n(l,{class:"stat-label"},{default:d(()=>[p("æ”¯å‡º")]),_:1}),n(l,{class:"stat-amount"},{default:d(()=>[p("Â¥"+v(q.value.toFixed(2)),1)]),_:1})]),_:1}),n(t,{class:"stat-card balance"},{default:d(()=>[n(l,{class:"stat-label"},{default:d(()=>[p("ç»“ä½™")]),_:1}),n(l,{class:"stat-amount"},{default:d(()=>[p("Â¥"+v(z.value.toFixed(2)),1)]),_:1})]),_:1})]),_:1})]),_:1}),n(t,{class:"records-list"},{default:d(()=>[0===A.value.length?(r(),o(t,{key:0,class:"empty-state"},{default:d(()=>[n(l,{class:"empty-text"},{default:d(()=>[p("æš‚æ— "+v("income"===D.value?"æ”¶å…¥":"æ”¯å‡º")+"è®°å½•",1)]),_:1})]),_:1})):(r(),o(t,{key:1,class:"records-container"},{default:d(()=>[(r(!0),y(g,null,x(A.value,e=>(r(),o(t,{key:e.id,class:"record-item",onClick:a=>(e=>{Y({title:"ç¼–è¾‘è®°å½•",content:"æ˜¯å¦è¦ç¼–è¾‘è¿™æ¡è®°å½•ï¼Ÿ",success:a=>{a.confirm&&(console.log("ç¼–è¾‘è®°å½•:",e),I.currentrecordId=e.id,M({url:"/pages/add-record/add-record"}))}})})(e)},{default:d(()=>[n(t,{class:"record-left"},{default:d(()=>[n(t,{class:"category-info"},{default:d(()=>[n(l,{class:"category-icon"},{default:d(()=>[p(v(G(e.category)),1)]),_:2},1024),n(l,{class:"category-name"},{default:d(()=>[p(v(e.category),1)]),_:2},1024)]),_:2},1024),n(l,{class:"record-remark"},{default:d(()=>[p(v(e.remark||"æ— å¤‡æ³¨"),1)]),_:2},1024)]),_:2},1024),n(t,{class:"record-right"},{default:d(()=>[n(l,{class:h(["record-amount",e.type])},{default:d(()=>[p(v("income"===e.type?"+":"-")+"Â¥"+v(e.amount.toFixed(2)),1)]),_:2},1032,["class"]),n(l,{class:"record-date"},{default:d(()=>{return[p(v((a=e.date,s(a).format("MM-DD"))),1)];var a}),_:2},1024)]),_:2},1024),n(l,{class:"edit-icon",onClick:k(a=>function(e){Y({title:"åˆ é™¤è®°å½•",content:"æ˜¯å¦è¦åˆ é™¤è¿™æ¡è®°å½•ï¼Ÿ",success:async a=>{if(a.confirm){let a=await I.deleteRecord(e.id);console.log(a),a.success&&C({title:"åˆ é™¤æˆåŠŸ",icon:"success"})}}})}(e),["stop"])},{default:d(()=>[p("åˆ é™¤")]),_:2},1032,["onClick"])]),_:2},1032,["onClick"]))),128))]),_:1}))]),_:1})]),_:1})}}},[["__scopeId","data-v-2578d302"]]);export{F as default};
