import{c as e,o as s,w as t,H as o,B as l,t as n,e as a,J as c,K as i,b as u,i as d,L as f,z as r,M as _,I as h,F as p,u as m,l as y,p as g,r as b,q as k,m as w,d as v,f as S,y as C,C as x,N as I,O as $,s as B,D as F}from"./index-CpIGjQk-.js";import{_ as V}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=[{font_class:"arrow-down",unicode:""},{font_class:"arrow-left",unicode:""},{font_class:"arrow-right",unicode:""},{font_class:"arrow-up",unicode:""},{font_class:"auth",unicode:""},{font_class:"auth-filled",unicode:""},{font_class:"back",unicode:""},{font_class:"bars",unicode:""},{font_class:"calendar",unicode:""},{font_class:"calendar-filled",unicode:""},{font_class:"camera",unicode:""},{font_class:"camera-filled",unicode:""},{font_class:"cart",unicode:""},{font_class:"cart-filled",unicode:""},{font_class:"chat",unicode:""},{font_class:"chat-filled",unicode:""},{font_class:"chatboxes",unicode:""},{font_class:"chatboxes-filled",unicode:""},{font_class:"chatbubble",unicode:""},{font_class:"chatbubble-filled",unicode:""},{font_class:"checkbox",unicode:""},{font_class:"checkbox-filled",unicode:""},{font_class:"checkmarkempty",unicode:""},{font_class:"circle",unicode:""},{font_class:"circle-filled",unicode:""},{font_class:"clear",unicode:""},{font_class:"close",unicode:""},{font_class:"closeempty",unicode:""},{font_class:"cloud-download",unicode:""},{font_class:"cloud-download-filled",unicode:""},{font_class:"cloud-upload",unicode:""},{font_class:"cloud-upload-filled",unicode:""},{font_class:"color",unicode:""},{font_class:"color-filled",unicode:""},{font_class:"compose",unicode:""},{font_class:"contact",unicode:""},{font_class:"contact-filled",unicode:""},{font_class:"down",unicode:""},{font_class:"bottom",unicode:""},{font_class:"download",unicode:""},{font_class:"download-filled",unicode:""},{font_class:"email",unicode:""},{font_class:"email-filled",unicode:""},{font_class:"eye",unicode:""},{font_class:"eye-filled",unicode:""},{font_class:"eye-slash",unicode:""},{font_class:"eye-slash-filled",unicode:""},{font_class:"fire",unicode:""},{font_class:"fire-filled",unicode:""},{font_class:"flag",unicode:""},{font_class:"flag-filled",unicode:""},{font_class:"folder-add",unicode:""},{font_class:"folder-add-filled",unicode:""},{font_class:"font",unicode:""},{font_class:"forward",unicode:""},{font_class:"gear",unicode:""},{font_class:"gear-filled",unicode:""},{font_class:"gift",unicode:""},{font_class:"gift-filled",unicode:""},{font_class:"hand-down",unicode:""},{font_class:"hand-down-filled",unicode:""},{font_class:"hand-up",unicode:""},{font_class:"hand-up-filled",unicode:""},{font_class:"headphones",unicode:""},{font_class:"heart",unicode:""},{font_class:"heart-filled",unicode:""},{font_class:"help",unicode:""},{font_class:"help-filled",unicode:""},{font_class:"home",unicode:""},{font_class:"home-filled",unicode:""},{font_class:"image",unicode:""},{font_class:"image-filled",unicode:""},{font_class:"images",unicode:""},{font_class:"images-filled",unicode:""},{font_class:"info",unicode:""},{font_class:"info-filled",unicode:""},{font_class:"left",unicode:""},{font_class:"link",unicode:""},{font_class:"list",unicode:""},{font_class:"location",unicode:""},{font_class:"location-filled",unicode:""},{font_class:"locked",unicode:""},{font_class:"locked-filled",unicode:""},{font_class:"loop",unicode:""},{font_class:"mail-open",unicode:""},{font_class:"mail-open-filled",unicode:""},{font_class:"map",unicode:""},{font_class:"map-filled",unicode:""},{font_class:"map-pin",unicode:""},{font_class:"map-pin-ellipse",unicode:""},{font_class:"medal",unicode:""},{font_class:"medal-filled",unicode:""},{font_class:"mic",unicode:""},{font_class:"mic-filled",unicode:""},{font_class:"micoff",unicode:""},{font_class:"micoff-filled",unicode:""},{font_class:"minus",unicode:""},{font_class:"minus-filled",unicode:""},{font_class:"more",unicode:""},{font_class:"more-filled",unicode:""},{font_class:"navigate",unicode:""},{font_class:"navigate-filled",unicode:""},{font_class:"notification",unicode:""},{font_class:"notification-filled",unicode:""},{font_class:"paperclip",unicode:""},{font_class:"paperplane",unicode:""},{font_class:"paperplane-filled",unicode:""},{font_class:"person",unicode:""},{font_class:"person-filled",unicode:""},{font_class:"personadd",unicode:""},{font_class:"personadd-filled",unicode:""},{font_class:"personadd-filled-copy",unicode:""},{font_class:"phone",unicode:""},{font_class:"phone-filled",unicode:""},{font_class:"plus",unicode:""},{font_class:"plus-filled",unicode:""},{font_class:"plusempty",unicode:""},{font_class:"pulldown",unicode:""},{font_class:"pyq",unicode:""},{font_class:"qq",unicode:""},{font_class:"redo",unicode:""},{font_class:"redo-filled",unicode:""},{font_class:"refresh",unicode:""},{font_class:"refresh-filled",unicode:""},{font_class:"refreshempty",unicode:""},{font_class:"reload",unicode:""},{font_class:"right",unicode:""},{font_class:"scan",unicode:""},{font_class:"search",unicode:""},{font_class:"settings",unicode:""},{font_class:"settings-filled",unicode:""},{font_class:"shop",unicode:""},{font_class:"shop-filled",unicode:""},{font_class:"smallcircle",unicode:""},{font_class:"smallcircle-filled",unicode:""},{font_class:"sound",unicode:""},{font_class:"sound-filled",unicode:""},{font_class:"spinner-cycle",unicode:""},{font_class:"staff",unicode:""},{font_class:"staff-filled",unicode:""},{font_class:"star",unicode:""},{font_class:"star-filled",unicode:""},{font_class:"starhalf",unicode:""},{font_class:"trash",unicode:""},{font_class:"trash-filled",unicode:""},{font_class:"tune",unicode:""},{font_class:"tune-filled",unicode:""},{font_class:"undo",unicode:""},{font_class:"undo-filled",unicode:""},{font_class:"up",unicode:""},{font_class:"top",unicode:""},{font_class:"upload",unicode:""},{font_class:"upload-filled",unicode:""},{font_class:"videocam",unicode:""},{font_class:"videocam-filled",unicode:""},{font_class:"vip",unicode:""},{font_class:"vip-filled",unicode:""},{font_class:"wallet",unicode:""},{font_class:"wallet-filled",unicode:""},{font_class:"weibo",unicode:""},{font_class:"weixin",unicode:""}];const M=V({name:"UniIcons",emits:["click"],props:{type:{type:String,default:""},color:{type:String,default:"#333333"},size:{type:[Number,String],default:16},customPrefix:{type:String,default:""},fontFamily:{type:String,default:""}},data:()=>({icons:z}),computed:{unicode(){let e=this.icons.find(e=>e.font_class===this.type);return e?e.unicode:""},iconSize(){return"number"==typeof(e=this.size)||/^[0-9]*$/g.test(e)?e+"px":e;var e},styleObj(){return""!==this.fontFamily?`color: ${this.color}; font-size: ${this.iconSize}; font-family: ${this.fontFamily};`:`color: ${this.color}; font-size: ${this.iconSize};`}},methods:{_onClick(){this.$emit("click")}}},[["render",function(c,i,u,d,f,r){const _=a;return s(),e(_,{style:n(r.styleObj),class:l(["uni-icons",["uniui-"+u.type,u.customPrefix,u.customPrefix?u.type:""]]),onClick:r._onClick},{default:t(()=>[o(c.$slots,"default",{},void 0,!0)]),_:3},8,["style","class","onClick"])}],["__scopeId","data-v-dae1b464"]]);function j(e){let s="";for(let t in e){s+=`${t}:${e[t]};`}return s}const P=V({name:"uni-easyinput",emits:["click","iconClick","update:modelValue","input","focus","blur","confirm","clear","eyes","change","keyboardheightchange"],model:{prop:"modelValue",event:"update:modelValue"},options:{virtualHost:!0},inject:{form:{from:"uniForm",default:null},formItem:{from:"uniFormItem",default:null}},props:{name:String,value:[Number,String],modelValue:[Number,String],type:{type:String,default:"text"},clearable:{type:Boolean,default:!0},autoHeight:{type:Boolean,default:!1},placeholder:{type:String,default:" "},placeholderStyle:String,focus:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},maxlength:{type:[Number,String],default:140},confirmType:{type:String,default:"done"},clearSize:{type:[Number,String],default:24},inputBorder:{type:Boolean,default:!0},prefixIcon:{type:String,default:""},suffixIcon:{type:String,default:""},trim:{type:[Boolean,String],default:!1},cursorSpacing:{type:Number,default:0},passwordIcon:{type:Boolean,default:!0},adjustPosition:{type:Boolean,default:!0},primaryColor:{type:String,default:"#2979ff"},styles:{type:Object,default:()=>({color:"#333",backgroundColor:"#fff",disableColor:"#F7F6F6",borderColor:"#e5e5e5"})},errorMessage:{type:[String,Boolean],default:""}},data:()=>({focused:!1,val:"",showMsg:"",border:!1,isFirstBorder:!1,showClearIcon:!1,showPassword:!1,focusShow:!1,localMsg:"",isEnter:!1}),computed:{isVal(){const e=this.val;return!(!e&&0!==e)},msg(){return this.localMsg||this.errorMessage},inputMaxlength(){return Number(this.maxlength)},boxStyle(){return`color:${this.inputBorder&&this.msg?"#e43d33":this.styles.color};`},inputContentClass(){return function(e){let s="";for(let t in e)e[t]&&(s+=`${t} `);return s}({"is-input-border":this.inputBorder,"is-input-error-border":this.inputBorder&&this.msg,"is-textarea":"textarea"===this.type,"is-disabled":this.disabled,"is-focused":this.focusShow})},inputContentStyle(){const e=this.focusShow?this.primaryColor:this.styles.borderColor;return j({"border-color":(this.inputBorder&&this.msg?"#dd524d":e)||"#e5e5e5","background-color":this.disabled?this.styles.disableColor:this.styles.backgroundColor})},inputStyle(){return j({"padding-right":"password"===this.type||this.clearable||this.prefixIcon?"":"10px","padding-left":this.prefixIcon?"":"10px",...this.styles})}},watch:{value(e){this.val=null!==e?e:""},modelValue(e){this.val=null!==e?e:""},focus(e){this.$nextTick(()=>{this.focused=this.focus,this.focusShow=this.focus})}},created(){this.init(),this.form&&this.formItem&&this.$watch("formItem.errMsg",e=>{this.localMsg=e})},mounted(){this.$nextTick(()=>{this.focused=this.focus,this.focusShow=this.focus})},methods:{init(){this.value||0===this.value?this.val=this.value:this.modelValue||0===this.modelValue||""===this.modelValue?this.val=this.modelValue:this.val=""},onClickIcon(e){this.$emit("iconClick",e)},onEyes(){this.showPassword=!this.showPassword,this.$emit("eyes",this.showPassword)},onInput(e){let s=e.detail.value;this.trim&&("boolean"==typeof this.trim&&this.trim&&(s=this.trimStr(s)),"string"==typeof this.trim&&(s=this.trimStr(s,this.trim))),this.errMsg&&(this.errMsg=""),this.val=s,this.$emit("input",s),this.$emit("update:modelValue",s)},onFocus(){this.$nextTick(()=>{this.focused=!0}),this.$emit("focus",null)},_Focus(e){this.focusShow=!0,this.$emit("focus",e)},onBlur(){this.focused=!1,this.$emit("blur",null)},_Blur(e){if(e.detail.value,this.focusShow=!1,this.$emit("blur",e),!1===this.isEnter&&this.$emit("change",this.val),this.form&&this.formItem){const{validateTrigger:e}=this.form;"blur"===e&&this.formItem.onFieldChange()}},onConfirm(e){this.$emit("confirm",this.val),this.isEnter=!0,this.$emit("change",this.val),this.$nextTick(()=>{this.isEnter=!1})},onClear(e){this.val="",this.$emit("input",""),this.$emit("update:modelValue",""),this.$emit("clear")},onkeyboardheightchange(e){this.$emit("keyboardheightchange",e)},trimStr:(e,s="both")=>"both"===s?e.trim():"left"===s?e.trimLeft():"right"===s?e.trimRight():"start"===s?e.trimStart():"end"===s?e.trimEnd():"all"===s?e.replace(/\s+/g,""):e}},[["render",function(a,m,y,g,b,k){const w=c(i("uni-icons"),M),v=_,S=h,C=d;return s(),e(C,{class:l(["uni-easyinput",{"uni-easyinput-error":k.msg}]),style:n(k.boxStyle)},{default:t(()=>[u(C,{class:l(["uni-easyinput__content",k.inputContentClass]),style:n(k.inputContentStyle)},{default:t(()=>[y.prefixIcon?(s(),e(w,{key:0,class:"content-clear-icon",type:y.prefixIcon,color:"#c0c4cc",onClick:m[0]||(m[0]=e=>k.onClickIcon("prefix")),size:"22"},null,8,["type"])):f("",!0),o(a.$slots,"left",{},void 0,!0),"textarea"===y.type?(s(),e(v,{key:1,class:l(["uni-easyinput__content-textarea",{"input-padding":y.inputBorder}]),name:y.name,value:b.val,placeholder:y.placeholder,placeholderStyle:y.placeholderStyle,disabled:y.disabled,"placeholder-class":"uni-easyinput__placeholder-class",maxlength:k.inputMaxlength,focus:b.focused,autoHeight:y.autoHeight,"cursor-spacing":y.cursorSpacing,"adjust-position":y.adjustPosition,onInput:k.onInput,onBlur:k._Blur,onFocus:k._Focus,onConfirm:k.onConfirm,onKeyboardheightchange:k.onkeyboardheightchange},null,8,["class","name","value","placeholder","placeholderStyle","disabled","maxlength","focus","autoHeight","cursor-spacing","adjust-position","onInput","onBlur","onFocus","onConfirm","onKeyboardheightchange"])):(s(),e(S,{key:2,type:"password"===y.type?"text":y.type,class:"uni-easyinput__content-input",style:n(k.inputStyle),name:y.name,value:b.val,password:!b.showPassword&&"password"===y.type,placeholder:y.placeholder,placeholderStyle:y.placeholderStyle,"placeholder-class":"uni-easyinput__placeholder-class",disabled:y.disabled,maxlength:k.inputMaxlength,focus:b.focused,confirmType:y.confirmType,"cursor-spacing":y.cursorSpacing,"adjust-position":y.adjustPosition,onFocus:k._Focus,onBlur:k._Blur,onInput:k.onInput,onConfirm:k.onConfirm,onKeyboardheightchange:k.onkeyboardheightchange},null,8,["type","style","name","value","password","placeholder","placeholderStyle","disabled","maxlength","focus","confirmType","cursor-spacing","adjust-position","onFocus","onBlur","onInput","onConfirm","onKeyboardheightchange"])),"password"===y.type&&y.passwordIcon?(s(),r(p,{key:3},[k.isVal?(s(),e(w,{key:0,class:l(["content-clear-icon",{"is-textarea-icon":"textarea"===y.type}]),type:b.showPassword?"eye-slash-filled":"eye-filled",size:22,color:b.focusShow?y.primaryColor:"#c0c4cc",onClick:k.onEyes},null,8,["class","type","color","onClick"])):f("",!0)],64)):f("",!0),y.suffixIcon?(s(),r(p,{key:4},[y.suffixIcon?(s(),e(w,{key:0,class:"content-clear-icon",type:y.suffixIcon,color:"#c0c4cc",onClick:m[1]||(m[1]=e=>k.onClickIcon("suffix")),size:"22"},null,8,["type"])):f("",!0)],64)):(s(),r(p,{key:5},[y.clearable&&k.isVal&&!y.disabled&&"textarea"!==y.type?(s(),e(w,{key:0,class:l(["content-clear-icon",{"is-textarea-icon":"textarea"===y.type}]),type:"clear",size:y.clearSize,color:k.msg?"#dd524d":b.focusShow?y.primaryColor:"#c0c4cc",onClick:k.onClear},null,8,["class","size","color","onClick"])):f("",!0)],64)),o(a.$slots,"right",{},void 0,!0)]),_:3},8,["class","style"])]),_:3},8,["class","style"])}],["__scopeId","data-v-f591c8c5"]]),T=V({__name:"profile",setup(o){const l=m(),n=y(),f=g(()=>l.userInfo||{}),r=g(()=>{if(0===n.records.length)return 0;return[...new Set(n.records.map(e=>w(e.date).format("YYYY-MM-DD")))].length}),_=g(()=>n.records.length),h=g(()=>n.balance),p=()=>{I({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:async e=>{const s=e.tempFilePaths[0];$({url:"http://192.168.1.102:3000/api/upload",filePath:s,name:"image",formData:{image:"image"},success:e=>{let s=JSON.parse(e.data);console.log(JSON.parse(e.data),"上传返回"),l.updateUserInfo({avatar:s.url}),B({title:"头像更新成功",icon:"success"})}})}})};async function V(){try{(await l.updateUserInfo({nickname:f.value.nickname})).success&&(z.value=!1),B({title:"用户昵称更新成功",icon:"success"})}catch(e){}}const z=b(!1),M=()=>{F({title:"编辑个人信息",content:"是否要编辑个人信息？",success:e=>{e.confirm&&(z.value=!0)}})},j=()=>{F({title:"导出数据",content:"是否要导出所有记账数据？",success:e=>{e.confirm&&B({title:"数据导出成功",icon:"success"})}})},T=()=>{F({title:"备份数据",content:"是否要备份当前数据？",success:e=>{e.confirm&&B({title:"数据备份成功",icon:"success"})}})},N=()=>{F({title:"恢复数据",content:"是否要恢复备份的数据？这将覆盖当前数据。",success:e=>{e.confirm&&B({title:"数据恢复成功",icon:"success"})}})},E=()=>{F({title:"关于应用",content:"个人记账 v1.0.0\n\n一个简单易用的个人记账应用，帮助您轻松管理财务。",showCancel:!1})},H=()=>{F({title:"意见反馈",content:"如有问题或建议，请联系开发者。",showCancel:!1})},O=()=>{B({title:"已是最新版本",icon:"success"})},K=()=>{F({title:"退出登录",content:"确定要退出登录吗？",success:e=>{e.confirm&&l.logout()}})};return k(async()=>{await n.fetchRecords()}),(o,l)=>{const n=v,m=a,y=c(i("uni-easyinput"),P),g=d;return s(),e(g,{class:"profile-container"},{default:t(()=>[u(g,{class:"user-card"},{default:t(()=>[u(g,{class:"user-info"},{default:t(()=>[u(n,{class:"avatar",src:f.value.avatar||"/static/bg.jpg",mode:"aspectFill",onClick:p},null,8,["src"]),u(g,{class:"user-details"},{default:t(()=>[z.value?(s(),e(y,{key:1,modelValue:f.value.nickname,"onUpdate:modelValue":l[0]||(l[0]=e=>f.value.nickname=e),placeholder:"请输入内容"},null,8,["modelValue"])):(s(),e(m,{key:0,class:"nickname"},{default:t(()=>[S(C(f.value.nickname||"未设置昵称"),1)]),_:1})),u(m,{class:"username"},{default:t(()=>[S(C(f.value.username),1)]),_:1})]),_:1}),u(g,{class:"edit-btn",onClick:M},{default:t(()=>[z.value?(s(),e(g,{key:1,class:"save",onClick:x(V,["stop"])},{default:t(()=>[S("确定")]),_:1})):(s(),e(m,{key:0,class:"edit-icon"},{default:t(()=>[S("✏️")]),_:1}))]),_:1})]),_:1}),u(g,{class:"stats-section"},{default:t(()=>[u(g,{class:"stat-item"},{default:t(()=>[u(m,{class:"stat-number"},{default:t(()=>[S(C(r.value),1)]),_:1}),u(m,{class:"stat-label"},{default:t(()=>[S("记账天数")]),_:1})]),_:1}),u(g,{class:"stat-item"},{default:t(()=>[u(m,{class:"stat-number"},{default:t(()=>[S(C(_.value),1)]),_:1}),u(m,{class:"stat-label"},{default:t(()=>[S("记账笔数")]),_:1})]),_:1}),u(g,{class:"stat-item"},{default:t(()=>[u(m,{class:"stat-number"},{default:t(()=>[S(C(h.value>=0?"+":"")+"¥"+C(h.value.toFixed(2)),1)]),_:1}),u(m,{class:"stat-label"},{default:t(()=>[S("总资产")]),_:1})]),_:1})]),_:1})]),_:1}),u(g,{class:"menu-section"},{default:t(()=>[u(g,{class:"menu-group"},{default:t(()=>[u(g,{class:"menu-item",onClick:j},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("📊")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("导出数据")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1}),u(g,{class:"menu-item",onClick:T},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("💾")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("备份数据")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1}),u(g,{class:"menu-item",onClick:N},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("🔄")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("恢复数据")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1})]),_:1}),u(g,{class:"menu-group"},{default:t(()=>[u(g,{class:"menu-item",onClick:E},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("ℹ️")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("关于应用")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1}),u(g,{class:"menu-item",onClick:H},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("💬")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("意见反馈")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1}),u(g,{class:"menu-item",onClick:O},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("🔄")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("检查更新")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1})]),_:1}),u(g,{class:"menu-group"},{default:t(()=>[u(g,{class:"menu-item logout",onClick:K},{default:t(()=>[u(g,{class:"menu-left"},{default:t(()=>[u(m,{class:"menu-icon"},{default:t(()=>[S("🚪")]),_:1}),u(m,{class:"menu-title"},{default:t(()=>[S("退出登录")]),_:1})]),_:1}),u(m,{class:"menu-arrow"},{default:t(()=>[S(">")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},[["__scopeId","data-v-b4679732"]]);export{T as default};
